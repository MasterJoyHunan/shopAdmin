webpackJsonp([5],{"9Bo7":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("m40h"),i={name:"addRecommend-content",mixins:[a("vsZy").a],data:function(){return{showDialog:!1,cate:[],params:{cate_id:""},form:{id:"",name:"",memo:"",sort:0,link:"",img:"",pid:""},isAdd:!0,formRule:{name:[{required:!0,message:"请输入推荐信息",trigger:"blur"}],pid:[{required:!0,type:"number",message:"请选择所属分类",trigger:"change"}]},inputValue:"",imgPostUrl:"http://www.masterjoy.top/vueapi//common/uploadImg"}},created:function(){var t=this;Object(n.g)().then(function(e){t.cate=e.data}).catch(function(t){console.log(t)})},methods:{skuImgUploadSuccess:function(t,e){1==t.status&&(this.form.img=t.data)},handelAdd:function(){var t=["","","",0,"","","",!0,!0];this.form.id=t[0],this.form.name=t[1],this.form.memo=t[2],this.form.sort=t[3],this.form.link=t[4],this.form.img=t[5],this.form.pid=t[6],this.showDialog=t[7],this.isAdd=t[8]},handleEdit:function(t,e){var a=[!0,!1,e];this.showDialog=a[0],this.isAdd=a[1],this.form=a[2]},onSubmit:function(){var t=this;this.$refs.cateForm.validate(function(e){if(!e)return!1;t.isAdd?Object(n.a)(t.form).then(function(e){t.$message({message:e.msg,type:"success"}),t._getData(),t.showDialog=!1}):Object(n.e)(t.form).then(function(e){t.$message({message:e.msg,type:"success"}),t._getData(),t.showDialog=!1})})},handleDel:function(t,e){var a=this;this.$confirm("是否确定删除该推荐内容","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.c)({id:e.id}).then(function(e){a.$message({message:"删除成功",type:"success"}),a.list.splice(t,1)})})},_getData:function(){var t=this;Object(n.h)(this.params).then(function(e){t.total=e.data.total,t.pageSize=e.data.per_page,t.page=e.data.current_page,t.list=e.data.data,t.table_loading=!1}).catch(function(e){t.table_loading=!0})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("p",{staticClass:"page-title"},[t._v("推荐位内容管理")]),t._v(" "),a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",plain:""},on:{click:function(e){t.handelAdd()}}},[t._v("添加推荐内容")]),t._v(" "),a("div",{staticStyle:{float:"right",display:"flex"}},[a("el-select",{staticStyle:{width:"200px",margin:"0 3px"},attrs:{placeholder:"选择所属推荐位"},model:{value:t.params.cate_id,callback:function(e){t.$set(t.params,"cate_id",e)},expression:"params.cate_id"}},t._l(t.cate,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(e){t.search()}}},[t._v("搜索")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.table_loading,expression:"table_loading"}],attrs:{"element-loading-text":"加载中...",border:"",fit:"","highlight-current-row":"",data:t.list}},[a("el-table-column",{attrs:{label:"ID",prop:"id",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"pinfo.name",label:"所属分类"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"推荐信息"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"memo",label:"推荐摘要"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"img",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.img?a("img",{staticClass:"scope-img",attrs:{src:t.cdn+e.row.img}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"link",label:"链接"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"sort",width:"60px",label:"排序"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"170px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑\n                ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDel(e.$index,e.row)}}},[t._v("删除\n                ")])]}}])})],1),t._v(" "),a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{background:"","current-page":t.params.page,"page-sizes":t.page_sizes,"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"update:currentPage":function(e){t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.showDialog,title:"添加推荐位内容",width:"30%"},on:{"update:visible":function(e){t.showDialog=e}}},[a("el-form",{ref:"cateForm",attrs:{model:t.form,"status-icon":"","label-width":"120px",rules:t.formRule},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"选择所属推荐位",prop:"pid"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.form.pid,callback:function(e){t.$set(t.form,"pid",e)},expression:"form.pid"}},t._l(t.cate,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"推荐信息",prop:"name"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"推荐摘要",prop:"memo"}},[a("el-input",{model:{value:t.form.memo,callback:function(e){t.$set(t.form,"memo",e)},expression:"form.memo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"推荐链接",prop:"link"}},[a("el-input",{model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"推荐图片"}},[a("el-upload",{staticClass:"upload-img-col",attrs:{"on-success":t.skuImgUploadSuccess,"show-file-list":!1,action:t.imgPostUrl}},[t.form.img?a("img",{staticClass:"upload-img",attrs:{slot:"trigger",src:t.cdn+t.form.img,alt:""},slot:"trigger"}):a("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",t._n(e))},expression:"form.sort"}})],1),t._v(" "),a("el-form-item",[a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")])],1)])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(i,o,!1,function(t){a("yzjJ")},"data-v-d8db9dd0",null);e.default=l.exports},m40h:function(t,e,a){"use strict";e.g=function(){return Object(n.a)({url:"Recommend/index"})},e.b=function(t){return Object(n.a)({url:"Recommend/addRecommendList",method:"post",data:t})},e.f=function(t){return Object(n.a)({url:"Recommend/editRecommendList",method:"post",data:t})},e.d=function(t){return Object(n.a)({url:"Recommend/delRecommendList",method:"post",data:t})},e.h=function(t){return Object(n.a)({url:"Recommend/content",method:"get",params:t})},e.a=function(t){return Object(n.a)({url:"Recommend/addRecommendContent",method:"post",data:t})},e.e=function(t){return Object(n.a)({url:"Recommend/editRecommendContent",method:"post",data:t})},e.c=function(t){return Object(n.a)({url:"Recommend/delRecommendContent",method:"post",data:t})};var n=a("vLgD")},yzjJ:function(t,e){}});