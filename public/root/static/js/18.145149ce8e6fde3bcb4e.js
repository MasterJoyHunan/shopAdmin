webpackJsonp([18],{"8qYA":function(t,e){},OaY7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("vLgD");var i={name:"product-cate",mixins:[a("vsZy").a],data:function(){return{showDialog:!1,params:{name:""},form:{name:"",sort:1},formRule:{name:[{required:!0,message:"请输入分类名",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"},{type:"number",message:"必须是数字",trigger:"blur"}]},inputValue:""}},methods:{addCate:function(){this.form.name="",this.form.sort=1,this.showDialog=!0},onSubmit:function(){var t=this;this.$refs.cateForm.validate(function(e){if(!e)return!1;var a;(a=t.form,Object(n.a)({url:"cate/addCate",data:a,method:"post"})).then(function(e){t.$message({message:e.msg,type:"success"}),t._getData(),t.showDialog=!1})})},handleEdit:function(t,e){var a,i=this;(a=e,Object(n.a)({url:"cate/editCate",data:a,method:"post"})).then(function(t){i.$message({message:t.msg,type:"success"}),e.old_name=e.name,e.edit=!1})},handleCancel:function(t){t.edit=!1,t.name=t.old_name,t.sort=t.old_sort},handleDel:function(t,e){var a=this;this.$confirm("是否确定删除该分类","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i;(i={id:e.id},Object(n.a)({url:"cate/delCate",params:i})).then(function(e){a.$message({message:"删除成功",type:"success"}),a.list.splice(t,1)})})},addAttr:function(t,e){var a=this;1==e?t.new_attr1=!0:t.new_attr2=!0,this.$nextTick(function(){a.$refs.inputEle.$refs.input.focus()}),this.inputValue=""},handleInputConfirm:function(t,e){var a,i={pid:t.id,level:e,name:this.inputValue};(a=i,Object(n.a)({url:"cate/addCateSku",params:a})).then(function(a){1==e?(t.attr1.push(a.data),t.new_attr1=!1):(t.attr2.push(a.data),t.new_attr2=!1)})},deleteAttr:function(t,e,a,i){var r;(r={id:e},Object(n.a)({url:"cate/delCateSku",params:r})).then(function(e){1==i?t.attr1.splice(a,1):t.attr2.splice(a,1)})},_getData:function(){var t,e=this;(t=this.params,Object(n.a)({url:"cate/index",params:t})).then(function(t){e.list=t.data.data.map(function(t){e.$set(t,"edit",!1),e.$set(t,"new_attr1",!1),e.$set(t,"new_attr2",!1);var a=[],n=[];return t.sku.length>0&&t.sku.forEach(function(t){1==t.level?a.push(t):n.push(t)}),t.attr1=a,t.attr2=n,t.old_name=t.name,t.old_sort=t.sort,t}),e.total=t.data.total,e.pageSize=t.data.per_page,e.page=t.data.current_page,e.table_loading=!1}).catch(function(t){e.table_loading=!0})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("p",{staticClass:"page-title"},[t._v("商品分类列表")]),t._v(" "),a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",plain:""},on:{click:function(e){t.addCate()}}},[t._v("添加分类")]),t._v(" "),a("div",{staticStyle:{float:"right"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"分类名"},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name",e)},expression:"params.name"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.table_loading,expression:"table_loading"}],attrs:{"element-loading-text":"加载中...",border:"",fit:"","highlight-current-row":"",data:t.list}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-tag",{attrs:{type:"success"}},[t._v("商品属性1 :")]),t._v(" "),t._l(e.row.attr1,function(n,i){return e.row.attr1?a("el-tag",{key:i,attrs:{closable:""},on:{close:function(a){t.deleteAttr(e.row,n.id,i,1)}}},[t._v(t._s(n.name)+"\n                    ")]):t._e()}),t._v(" "),e.row.new_attr1?a("el-input",{ref:"inputEle",staticClass:"input-new-tag",attrs:{size:"small",placeholder:"回车添加"},on:{blur:function(t){e.row.new_attr1=!1}},nativeOn:{keyup:function(a){if(!("button"in a)&&t._k(a.keyCode,"enter",13,a.key,"Enter"))return null;t.handleInputConfirm(e.row,1)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){t.addAttr(e.row,1)}}},[t._v("+ 添加新属性\n                    ")])],2),t._v(" "),a("p",{staticStyle:{"border-bottom":"solid #ebeef5 1px"}}),t._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("el-tag",{attrs:{type:"success"}},[t._v("商品属性2 :")]),t._v(" "),t._l(e.row.attr2,function(n,i){return e.row.attr2?a("el-tag",{key:i,attrs:{closable:""},on:{close:function(a){t.deleteAttr(e.row,n.id,i,2)}}},[t._v(t._s(n.name)+"\n                    ")]):t._e()}),t._v(" "),e.row.new_attr2?a("el-input",{ref:"inputEle",staticClass:"input-new-tag",attrs:{size:"small",placeholder:"回车添加"},on:{blur:function(t){e.row.new_attr2=!1}},nativeOn:{keyup:function(a){if(!("button"in a)&&t._k(a.keyCode,"enter",13,a.key,"Enter"))return null;t.handleInputConfirm(e.row,2)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){t.addAttr(e.row,2)}}},[t._v("+ 添加新属性\n                    ")])],2)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"ID",prop:"id",align:"center",width:"60px"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"分类名"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:e.row.name,callback:function(a){t.$set(e.row,"name",a)},expression:"scope.row.name"}}):a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"排序(降序)",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-input",{staticClass:"edit-input",attrs:{size:"small",type:"number"},model:{value:e.row.sort,callback:function(a){t.$set(e.row,"sort",t._n(a))},expression:"scope.row.sort"}}):a("span",[t._v(t._s(e.row.sort))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"添加时间",prop:"add_time"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"400px",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",type:"warning"},on:{click:function(a){t.handleCancel(e.row)}}},[t._v("取消\n                ")]):t._e(),t._v(" "),e.row.edit?a("el-button",{attrs:{icon:"el-icon-circle-check-outline",size:"mini",type:"success"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("保存\n                ")]):a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.row.edit=!e.row.edit}}},[t._v("编辑\n                ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-close"},on:{click:function(a){t.handleDel(e.$index,e.row)}}},[t._v("删除\n                ")])]}}])})],1),t._v(" "),a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{background:"","current-page":t.params.page,"page-sizes":t.page_sizes,"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"update:currentPage":function(e){t.$set(t.params,"page",e)},"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.showDialog,title:"添加分类",width:"30%"},on:{"update:visible":function(e){t.showDialog=e}}},[a("el-form",{ref:"cateForm",attrs:{model:t.form,"status-icon":"","label-width":"100px",rules:t.formRule},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"分类名",prop:"name"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{attrs:{type:"number"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",t._n(e))},expression:"form.sort"}})],1),t._v(" "),a("el-form-item",[a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")])],1)])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(i,r,!1,function(t){a("8qYA")},"data-v-01c30e24",null);e.default=l.exports}});